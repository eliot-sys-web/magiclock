<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="/iphone-lock/Lock180.png">

<!-- Manifest PWA pour Android/Chrome -->
<link rel="manifest" href="/iphone-lock/manifest.json">
<title>iPhone 13 Lock Screen</title>
<style>
:root {
    --dot-size: 18px;
    --dot-spacing: 17px;
    --dots-top: calc(50vh - 100px); /* Position optimale pour iPhone 13 */
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
    user-select: none;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    overflow: hidden;
    background: #000;
    width: 100vw;
    height: 100vh;
    position: fixed;
    top: 0;
    left: 0;
    touch-action: manipulation;
}

#lockscreen {
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 100;
}

.dots-container {
    position: absolute;
    top: var(--dots-top);
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: var(--dot-spacing);
    z-index: 10;
    pointer-events: none;
}

.dot {
    width: var(--dot-size);
    height: var(--dot-size);
    border-radius: 50%;
    border: 2px solid rgba(255,255,255,0.3);
    background: transparent;
    transition: all 0.1s ease;
}

.dot.filled {
    background: white;
    border-color: white;
}

/* Zones tactiles invisibles (positionnement exact iPhone 13) */
.touch-area {
    position: absolute;
    border-radius: 50%;
    z-index: 5;
    opacity: 0;
}

.touch-1 { left: 25%; top: 40%; width: 20%; height: 10%; }
.touch-2 { left: 50%; top: 40%; width: 20%; height: 10%; }
.touch-3 { left: 75%; top: 40%; width: 20%; height: 10%; }
.touch-4 { left: 25%; top: 50%; width: 20%; height: 10%; }
.touch-5 { left: 50%; top: 50%; width: 20%; height: 10%; }
.touch-6 { left: 75%; top: 50%; width: 20%; height: 10%; }
.touch-7 { left: 25%; top: 60%; width: 20%; height: 10%; }
.touch-8 { left: 50%; top: 60%; width: 20%; height: 10%; }
.touch-9 { left: 75%; top: 60%; width: 20%; height: 10%; }
.touch-0 { left: 50%; top: 70%; width: 20%; height: 10%; }

/* Mode debug - décommente pour voir les zones */
/*
.touch-area {
    background: rgba(255,0,0,0.2);
    border: 1px solid red;
    opacity: 1;
}
*/
</style>
</head>
<body>
<div id="lockscreen">
    <!-- Cercles visuels -->
    <div class="dots-container">
        <div class="dot" data-key="1"></div>
        <div class="dot" data-key="2"></div>
        <div class="dot" data-key="3"></div>
        <div class="dot" data-key="4"></div>
        <div class="dot" data-key="5"></div>
        <div class="dot" data-key="6"></div>
    </div>

    <!-- Zones tactiles (invisibles) -->
    <div class="touch-area touch-1" data-key="1"></div>
    <div class="touch-area touch-2" data-key="2"></div>
    <div class="touch-area touch-3" data-key="3"></div>
    <div class="touch-area touch-4" data-key="4"></div>
    <div class="touch-area touch-5" data-key="5"></div>
    <div class="touch-area touch-6" data-key="6"></div>
    <div class="touch-area touch-7" data-key="7"></div>
    <div class="touch-area touch-8" data-key="8"></div>
    <div class="touch-area touch-9" data-key="9"></div>
    <div class="touch-area touch-0" data-key="0"></div>
</div>

<script>
// Code de déverrouillage par défaut (modifiable)
const UNLOCK_CODE = "123456";

// Gestion des touches
document.querySelectorAll('.touch-area').forEach(area => {
    area.addEventListener('touchstart', handleTouch);
});

function handleTouch(e) {
    e.preventDefault();
    const key = e.currentTarget.getAttribute('data-key');
    const dot = document.querySelector(`.dot[data-key="${key}"]`);

    // Animation de pression
    dot.classList.add('filled');
    setTimeout(() => {
        dot.classList.remove('filled');
    }, 300);

    // Logique de déverrouillage (à compléter)
    console.log(`Touche ${key} pressée`);
}

// Ajustement automatique pour iPhone 13
function adjustForiPhone13() {
    const isiPhone13 = /iPhone13/.test(navigator.userAgent) ||
                      (window.screen.height === 844 && window.screen.width === 390);

    if (isiPhone13) {
        document.documentElement.style.setProperty('--dots-top', 'calc(50vh - 90px)');
    }
}

// Initialisation
window.addEventListener('load', () => {
    adjustForiPhone13();

    // Charger l'image de fond si disponible
    const bgImage = localStorage.getItem('lockscreenBg');
    if (bgImage) {
        document.getElementById('lockscreen').style.backgroundImage = `url(${bgImage})`;
    }
});
</script>
</body>
</html>
